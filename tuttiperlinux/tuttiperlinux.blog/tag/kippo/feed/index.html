<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	xmlns:georss="http://www.georss.org/georss" xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#" xmlns:media="http://search.yahoo.com/mrss/"
	>

<channel>
	<title>kippo &#8211; Tutti per Linux</title>
	<atom:link href="https://tuttiperlinux.blog/tag/kippo/feed/" rel="self" type="application/rss+xml" />
	<link>https://tuttiperlinux.blog</link>
	<description>Tutto cio&#039; che avresti sempre voluto capire su Linux ed il mondo Digitale</description>
	<lastBuildDate>Wed, 03 Sep 2014 20:20:55 +0000</lastBuildDate>
	<language>it-IT</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>http://wordpress.com/</generator>
<cloud domain='tuttiperlinux.blog' port='80' path='/?rsscloud=notify' registerProcedure='' protocol='http-post' />
<image>
		<url>https://secure.gravatar.com/blavatar/fa5c4cf69896031d9ec71ff8d5aafd25?s=96&#038;d=https%3A%2F%2Fs0.wp.com%2Fi%2Fbuttonw-com.png</url>
		<title>kippo &#8211; Tutti per Linux</title>
		<link>https://tuttiperlinux.blog</link>
	</image>
	<atom:link rel="search" type="application/opensearchdescription+xml" href="https://tuttiperlinux.blog/osd.xml" title="Tutti per Linux" />
	<atom:link rel='hub' href='https://tuttiperlinux.blog/?pushpress=hub'/>
	<item>
		<title>Sicurezza &#8211; Honeypot SSH</title>
		<link>https://tuttiperlinux.blog/2014/09/03/sicurezza-honeypot-ssh/</link>
					<comments>https://tuttiperlinux.blog/2014/09/03/sicurezza-honeypot-ssh/#comments</comments>
		
		<dc:creator><![CDATA[Tutti per Linux]]></dc:creator>
		<pubDate>Wed, 03 Sep 2014 12:43:20 +0000</pubDate>
				<category><![CDATA[Sicurezza]]></category>
		<category><![CDATA[authbind]]></category>
		<category><![CDATA[bruteforce]]></category>
		<category><![CDATA[debian]]></category>
		<category><![CDATA[firewall]]></category>
		<category><![CDATA[framework]]></category>
		<category><![CDATA[honeyd]]></category>
		<category><![CDATA[honeypot]]></category>
		<category><![CDATA[kippo]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[ssh]]></category>
		<category><![CDATA[sudoers]]></category>
		<category><![CDATA[ubuntu]]></category>
		<guid isPermaLink="false">http://tuttiperlinux.com/?p=476</guid>

					<description><![CDATA[Un Honeypot SSH con Kippo Chiunque abbia un minimo di esperienza nel mettere a punto server rivolti verso Internet conosce bene la quantità di scansioni e di attacchi automatizzati che si possono ricevere in brevissimo tempo, a volte nel momento stesso in cui ci si collega in Rete. Molti scanner non sono sofisticati e si &#8230; <a href="https://tuttiperlinux.blog/2014/09/03/sicurezza-honeypot-ssh/">Continua a leggere <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<h3><strong><a href="https://tuttiperlinux.files.wordpress.com/2014/09/kippo-300x86.png"><img data-attachment-id="477" data-permalink="https://tuttiperlinux.blog/2014/09/03/sicurezza-honeypot-ssh/kippo-300x86/#main" data-orig-file="https://tuttiperlinux.files.wordpress.com/2014/09/kippo-300x86.png" data-orig-size="300,86" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Kippo honeypot" data-image-description="&lt;p&gt;Kippo SSH Honeypot &lt;/p&gt;
" data-image-caption="" data-medium-file="https://tuttiperlinux.files.wordpress.com/2014/09/kippo-300x86.png?w=300" data-large-file="https://tuttiperlinux.files.wordpress.com/2014/09/kippo-300x86.png?w=300" class="alignleft size-full wp-image-477" src="https://tuttiperlinux.files.wordpress.com/2014/09/kippo-300x86.png?w=600" alt="Kippo honeypot" srcset="https://tuttiperlinux.files.wordpress.com/2014/09/kippo-300x86.png 300w, https://tuttiperlinux.files.wordpress.com/2014/09/kippo-300x86.png?w=150 150w" sizes="(max-width: 300px) 100vw, 300px"   /></a>Un Honeypot SSH con Kippo</strong></h3>
<p>Chiunque abbia un minimo di esperienza nel mettere a punto server rivolti verso Internet conosce bene la quantità di <strong>scansioni e di attacchi automatizzati che si possono ricevere</strong> in brevissimo tempo, a volte nel momento stesso in cui ci si collega in Rete.</p>
<p>Molti scanner non sono sofisticati e si limitano a cercare porte<strong> ssh</strong> aperte per tentare un <strong>bruteforce</strong> e, in caso di successo, passare il controllo ad un attaccante umano (un cracker non un hacker).</p>
<p>Come descritto in un precedente articolo &#8220;<a title="Sicurezza con il PortKnocking" href="http://tuttiperlinux.com/2014/08/30/sicurezza-con-il-portknocking/"><strong>Sicurezza con il PortKnocking</strong></a>&#8221; , i passi da fare per mettersi al sicuro non sono mai abbastanza ed inparticolare alcuni servizi vanno completamente blindati anche solo per evitare enormi moli di log del firewall, solo per i tentativi di login al servizio SSH; proprio per questi motivi un ottimo esercizio e&#8217; quello di creare un honeypot partendo da quest&#8217;ultimo servizio.</p>
<p>In questo contesto si colloca <a href="http://code.google.com/p/kippo">Kippo</a>: un <strong>honeypot</strong> che simula un <strong>server ssh vulnerabile</strong> il cui obiettivo è quello di impegnare un attaccante e registrarne i movimenti. E&#8217; un tool open source scritto in Python progettato quindi per registrare attacchi di tipo bruteforce e, soprattutto, l&#8217;intera interazione shell effettuata dall&#8217; attaccante. In pratica quando un utente malintenzionato cercherà di entrare nel vostro sistema si troverà davanti un finto sistema che registrerà tutte le sue attività.</p>
<p>Kippo nel tempo si è guadagnato una certa popolarità dovuta alla sua semplicità d’uso, portabilità e al fatto che permette di <strong>riprodurre i log degli attacchi registrati</strong>.</p>
<h2>Installazione</h2>
<p>Kippo è programmato in <a href="http://www.html.it/guide/guida-python/" target="_blank">Python</a> e si basa sul framework Twisted, è necessario quindi un interprete python almeno alla versione 2.5.</p>
<p>I requisiti sono i seguenti:</p>
<ul>
<li>Python 2.5+</li>
<li>Twisted 8.0+</li>
<li>PyCrypto</li>
<li>Zope Interface</li>
</ul>
<p>come prima cosa bisogna cambiare la porta del server SSH per fare questo basta aprire e modificare il file sshd_config:</p>
<h5># vim /etc/ssh/sshd_config</h5>
<p>e sostituire la porta 22 con un’altra a vostra scelta,</p>
<p>Dopo aver modificato il parametro Port 22 con un altro (es. 2443) riavviare il servizio con il commando:</p>
<h5><strong> </strong># /etc/init.d/ssh restart</h5>
<p>Una volta sistemato questo piccolo dettaglio, bisogna installare tutti i pacchetti necessari per il corretto funzionamento di Kippo:</p>
<p>Prima di mettere in esecuzione l&#8217; honeypot occorre configurarlo agendo sui parametri nel file <code>kippo.cfg</code>.</p>
<p>Le principali opzioni sono le seguenti:</p>
<ul>
<li><strong><code>ssh_addr</code></strong>: l’indirizzo dell’interfaccia su cui vogliamo mettere kippo in ascolto (di default su tutte)</li>
<li><strong><code>ssh_port</code></strong>: il numero della porta</li>
<li><strong><code>password</code></strong>: la password per collegarsi all&#8217; honeypot, di default è <code>123456</code> che statisticamente è la password più comune che si può trovare. Se impostiamo una password <em>difficile</em> rischiamo di far fallire un attacco brute force! e ci perdiamo il bello del divertimento.</li>
<li><strong><code>[database_mysql]</code></strong>: parametri per loggare tutta l’attività di kippo su un db mysql. Di default questa opzione non è attiva.</li>
</ul>
<p>Su Linux per motivi di sicurezza kippo <strong>non</strong> può essere eseguita <strong>come</strong> <strong>root</strong> e quindi non può mettersi direttamente in ascolto sulle porte basse del sistema (&lt; 1024) tra cui anche quella di default del server ssh (la porta 22).</p>
<p>Per reindirizzare la porta 22 sulla porta in cui abbiamo messo in ascolto la honeypot dobbiamo impostare un reindirizzamento con il firewall di sistema. L’impostazione corretta dipende dal firewall che state usando sul vostro server e dalla tipologia della rete.</p>
<p>Ad esempio con iptables:</p>
<pre>iptables -A PREROUTING -t nat -i eth0 -p tcp --dport 22 -j REDIRECT --to-port 2443</pre>
<p>oppure usando l&#8217;ottimo tool <strong>rinetd</strong>, come spiegato enll&#8217;articolo &#8220;<strong><a title="Catturare il traffico di rete" href="http://tuttiperlinux.com/2014/08/06/catturare-il-traffico-di-rete/">Catturare il traffico di rete</a></strong>&#8220;.</p>
<h5>Installiamo i pacchetti</h5>
<pre># apt-get install python-dev openssl python-openssl python-pyasn1 python-twisted</pre>
<p>Visto che la porta 22 (che kippo dovrà monitorare) può essere utilizzata solo dall&#8217; utente root e per ragioni di sicurezza non è consigliato usare kippo come utente root bisogna installare un altra piccola applicazione, <strong>Authbind</strong>, che ci permetterà di eseguire kippo sulla porta 22:</p>
<h5><strong># apt-get install authbind</strong></h5>
<p>Ora creiamo un altro utente (non-root) che useremmo per eseguire kippo (non è vietato eseguire kippo come root ma per ragioni di sicurezza è consigliato usare un utente apposito):</p>
<h5># adduser kippo</h5>
<p>e aggiungiamolo alla lista dei sudoers:</p>
<p><strong> # vim /etc/sudoers</strong></p>
<p>aggiungendo la seguente stringa nel file:</p>
<h5>kippo ALL=(ALL:ALL) ALL</h5>
<p>(sotto l’utente root)</p>
<p><strong> </strong>Non ci resta che dare all&#8217; utente kippo i privilegi per usare la porta 22:</p>
<h5># touch /etc/authbind/byport/22<br />
# chown kippo:kippo /etc/authbind/byport/22<br />
# chmod 777 /etc/authbind/byport/22</h5>
<p>Ora non ci resta che cambiare utente ed entrare nel sistema con l’utente kippo, una volta cambiato utente siamo pronti a scaricare kippo (verificare sul sito del progetto per nuove versioni):</p>
<h5># wget <a href="https://kippo.googlecode.com/files/kippo-0.8.tar.gz" rel="nofollow">https://kippo.googlecode.com/files/kippo-0.8.tar.gz</a> /home/&lt;utente xxx&gt;/Downloads/</h5>
<p>estraiamo i file:</p>
<h5># tar -zxvf kippo-0.8.tar.gz -C /opt/</h5>
<p>ora ci spostiamo nella cartella del programma e modifichiamo il file kippo.cfg inserendo la porta 22 come target (di default è impostata la 2222) con la porta da voi prescelta, tipo la 2443.</p>
<h5><strong># vim kippo.cfg</strong></h5>
<p>ed in fine modifichiamo il file start.sh:</p>
<h5><strong># vim start.sh</strong></h5>
<p>sostituendo la stringa:</p>
<h5><strong>twistd -y kippo.tac -l log/kippo.log &#8211;pidfile kippo.pid</strong></h5>
<p>con:</p>
<h5><strong>authbind &#8211;deep twistd -y kippo.tac -l log/kippo.log &#8211;pidfile kippo.pid</strong></h5>
<p>ora non ci resta che eseguire il programma con:</p>
<h5><strong># ./start.sh</strong></h5>
<p>&#8230;&#8230; e qualsiasi tentativo di connettersi alla porta 22 del sistema sarà registrato da Kippo e file di log verranno archiviati nella cartella corrispondente. Kippo rimane in esecuzione in background e aspetta che qualche attaccante si faccia vivo.</p>
<p>Quando finalmente riusciremo a <strong>registrare un attacco</strong> (e solitamente è questione di solo poche ore!) l’honeypot si occuperà di registrare ogni movimento.</p>
<p>Nella cartella <code><strong>log</strong>/</code> verranno salvati i log interattivi delle sessioni registrate e in quella <code><strong>dl</strong>/</code> verranno salvati i file e gli eseguibili che gli ignari attaccanti tenteranno di scaricare sul server (di solito rootkit, malware generici, etc)</p>
<p>Il divertimento, una volta collezionati un po di log interattivi, è quello di riprodurli con il <code>playlog</code> che è una utilità che permette di <strong>riprodurre i log come se fossero un video</strong>.</p>
<p>Il programma si trova nella cartella <code>utils/</code>, per eseguirlo (da linea di comando):</p>
<pre>python playlog.py /path/to/xxx.log

</pre>
<h2>Statistiche</h2>
<p>Quando si ha una honeypot funzionante a pieno regime può risultare scomodo controllare periodicamente i log per capire il numero di attacchi ricevuti, la durata e altre informazioni utili.</p>
<p>Per facilitarci le cose possiamo affidarci a un programma come <a href="http://bruteforce.gr/kippo-graph">Kippo Graph</a> che si occupa di generare statistiche dettagliate e farci risparmiare del tempo prezioso.</p>
]]></content:encoded>
					
					<wfw:commentRss>https://tuttiperlinux.blog/2014/09/03/sicurezza-honeypot-ssh/feed/</wfw:commentRss>
			<slash:comments>1</slash:comments>
		
		
		
		<media:content url="https://2.gravatar.com/avatar/855ab7cb725a5b56c356471b79d1cef6?s=96&#38;d=&#38;r=G" medium="image">
			<media:title type="html">lordisil72lordisil72</media:title>
		</media:content>

		<media:content url="https://tuttiperlinux.files.wordpress.com/2014/09/kippo-300x86.png" medium="image">
			<media:title type="html">Kippo honeypot</media:title>
		</media:content>
	</item>
	</channel>
</rss>

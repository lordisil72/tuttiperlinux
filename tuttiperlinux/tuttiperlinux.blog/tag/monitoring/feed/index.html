<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	xmlns:georss="http://www.georss.org/georss" xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#" xmlns:media="http://search.yahoo.com/mrss/"
	>

<channel>
	<title>monitoring &#8211; Tutti per Linux</title>
	<atom:link href="https://tuttiperlinux.blog/tag/monitoring/feed/" rel="self" type="application/rss+xml" />
	<link>https://tuttiperlinux.blog</link>
	<description>Tutto cio&#039; che avresti sempre voluto capire su Linux ed il mondo Digitale</description>
	<lastBuildDate>Mon, 30 Jan 2017 13:51:36 +0000</lastBuildDate>
	<language>it-IT</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>http://wordpress.com/</generator>
<cloud domain='tuttiperlinux.blog' port='80' path='/?rsscloud=notify' registerProcedure='' protocol='http-post' />
<image>
		<url>https://secure.gravatar.com/blavatar/fa5c4cf69896031d9ec71ff8d5aafd25?s=96&#038;d=https%3A%2F%2Fs0.wp.com%2Fi%2Fbuttonw-com.png</url>
		<title>monitoring &#8211; Tutti per Linux</title>
		<link>https://tuttiperlinux.blog</link>
	</image>
	<atom:link rel="search" type="application/opensearchdescription+xml" href="https://tuttiperlinux.blog/osd.xml" title="Tutti per Linux" />
	<atom:link rel='hub' href='https://tuttiperlinux.blog/?pushpress=hub'/>
	<item>
		<title>Difenditi con ARTILLERY</title>
		<link>https://tuttiperlinux.blog/2017/01/30/1296/</link>
					<comments>https://tuttiperlinux.blog/2017/01/30/1296/#respond</comments>
		
		<dc:creator><![CDATA[Tutti per Linux]]></dc:creator>
		<pubDate>Mon, 30 Jan 2017 13:51:11 +0000</pubDate>
				<category><![CDATA[Networking]]></category>
		<category><![CDATA[Sicurezza]]></category>
		<category><![CDATA[SysAdmin]]></category>
		<category><![CDATA[alerting]]></category>
		<category><![CDATA[artillery]]></category>
		<category><![CDATA[brute force]]></category>
		<category><![CDATA[firewall]]></category>
		<category><![CDATA[git]]></category>
		<category><![CDATA[github]]></category>
		<category><![CDATA[honeypot]]></category>
		<category><![CDATA[iptables]]></category>
		<category><![CDATA[monitoring]]></category>
		<category><![CDATA[python]]></category>
		<category><![CDATA[security]]></category>
		<category><![CDATA[social engineering toolkit]]></category>
		<guid isPermaLink="false">http://tuttiperlinux.com/?p=1296</guid>

					<description><![CDATA[In questo articolo parleremo di un tool che si pone come interessante aiuto verso la sicurezza delle nostre macchine in rete, il suo nome e&#8217; Artillery , esso è un interessante software scritto interamente in python. La cosa molto interessante di questo tool e&#8217; che lo possiamo intendere come una combinazione tra un honeypot, un tool &#8230; <a href="https://tuttiperlinux.blog/2017/01/30/1296/">Continua a leggere <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<div data-shortcode="caption" id="attachment_1297" style="width: 257px" class="wp-caption alignnone"><img loading="lazy" aria-describedby="caption-attachment-1297" data-attachment-id="1297" data-permalink="https://tuttiperlinux.blog/2017/01/30/1296/project-artillery/#main" data-orig-file="https://tuttiperlinux.files.wordpress.com/2017/01/project-artillery.png" data-orig-size="284,345" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="project-artillery" data-image-description="&lt;p&gt;Artillery Honeypot All-in-one&lt;/p&gt;
" data-image-caption="&lt;p&gt;Artillery Honeypot All-in-one&lt;/p&gt;
" data-medium-file="https://tuttiperlinux.files.wordpress.com/2017/01/project-artillery.png?w=247" data-large-file="https://tuttiperlinux.files.wordpress.com/2017/01/project-artillery.png?w=284" class="size-medium wp-image-1297" src="https://tuttiperlinux.files.wordpress.com/2017/01/project-artillery.png?w=247&#038;h=300" alt="Artillery Honeypot All-in-one" width="247" height="300" srcset="https://tuttiperlinux.files.wordpress.com/2017/01/project-artillery.png?w=247&amp;h=300 247w, https://tuttiperlinux.files.wordpress.com/2017/01/project-artillery.png?w=123&amp;h=150 123w, https://tuttiperlinux.files.wordpress.com/2017/01/project-artillery.png 284w" sizes="(max-width: 247px) 100vw, 247px" /><p id="caption-attachment-1297" class="wp-caption-text">Artillery Honeypot All-in-one</p></div>
<p>In questo articolo parleremo di un tool che si pone come interessante aiuto verso la sicurezza delle nostre macchine in rete, il suo nome e&#8217; <strong>Artillery </strong>, esso è un interessante software scritto interamente in python. La cosa molto interessante di questo tool e&#8217; che lo possiamo intendere come una combinazione tra un honeypot, un tool di monitoraggio, ed un sistema di alerting. Uahoooo, tutto in un&#8217;unico strumento&#8230;&#8230;.</p>
<p>I principi di funzionamento si caratterizzano dal fatto che in presenza di determinate attività di networking esso si comporta parzialmente come un honeypot, adottando anche manovre evasive e, contemporaneamente monitorizza il cambiamento di file sensibili; in entrambi i casi avvisando di quanto riscontrato i destinatari designati.<br />
Artillery si pone in ascolto su di un certo numero di porte di uso comune (peraltro configurabile, tramite la variabile PORTS), e qualora riceva una richiesta di connessione per uno qualsiasi dei servizi fasulli, blocca in modo permanente l’indirizzo IP sorgente aggiungendo una relativa regola con target DROP a iptables.</p>
<p><strong>Artillery può essere anche usato per prevenire attacchi di tipo brute force<br />
</strong><br />
L’ installazione ed il lancio di Artillery sono molto semplici: una volta effettuato il download via <strong>git</strong>, occorre lanciare uno script installer, editare un file di configurazione (&#8220;all&#8217;inizio questo passaggio sara&#8217; meglio farlo su macchina virtuale per fare pratica della configurazione delle regole&#8221;) e poi mandarlo in esecuzione:</p>
<p># cd /opt<br />
# <code>apt-get update &amp;&amp; apt-get install git [solo se ancora non avete installato il pacchetto git]<br />
# git clone https://github.com/trustedsec/artillery/ artillery/<br />
# cd artillery<br />
</code># sudo ./setup.py</p>
<p>Welcome to the Artillery installer. Artillery is a honeypot, file monitoring, and overall security tool used to protect your nix systems.</p>
<p>Written by: Dave Kennedy (ReL1K)</p>
<p>Do you want to install Artillery and have it automatically run when you restart [y/n]: y<br />
[*] Beginning installation. This should only take a moment.<br />
[*] Adding artillery into startup through init scripts..<br />
[*] Triggering update-rc.d on artillery to automatic start&#8230;<br />
Do you want to keep Artillery updated? (requires internet) [y/n]: y<br />
[*] Checking out Artillery through github to /var/artillery<br />
Cloning into &#8216;/var/artillery&#8217;&#8230;<br />
remote: Counting objects: 876, done.<br />
remote: Total 876 (delta 0), reused 0 (delta 0), pack-reused 876<br />
Receiving objects: 100% (876/876), 207.83 KiB | 293.00 KiB/s, done.<br />
Resolving deltas: 100% (568/568), done.<br />
Checking connectivity&#8230; done.<br />
[*] Finished. If you want to update Artillery go to /var/artillery and type &#8216;git pull&#8217;<br />
Would you like to start Artillery now? [y/n]: y<br />
Starting Artillery&#8230; Ok<br />
[*] Installation complete. Edit /var/artillery/config in order to config artillery to your liking..</p>
<p>Durante il processo di installazione verranno poste, come potete leggere qui sopra, alcune domande:<br />
Do you want to install Artillery and have it automatically run when you restart [y/n]:<br />
Do you want to keep Artillery updated? (requires internet) [y/n]:<br />
Would you like to start Artillery now? [y/n]:</p>
<p>Artillery verrà installato come servizio sotto /etc/init.d/<br />
E’ sempre consigliabile leggere con attenzione prima d&#8217; impostare il file di configurazione.<br />
In ogni caso, una volta effettuate delle modifiche alla configurazione, si può impartire e renderle immediatamente operanti:<br />
# python restart_server.py</p>
<p>Fate attenzione a non commettere l’errore di editare invece i files risultanti dal download via git. Una volta che che lo script di installazione sia stato eseguito, per modificarne la configurazione posizionatevi piuttosto nella directory /var/artillery.</p>
<p>Il contenuto del file <strong>config</strong> è piuttosto chiarificatore delle funzionalità del software:<br />
# determina se attivare l&#8217;attività di monitoraggio dell&#8217;integrità di files sensibili<br />
MONITOR=YES<br />
#<br />
# le directories da monitorare, se ne possono ancora aggiungere &#8220;/root&#8221;,&#8221;/var/&#8221;, ecc.<br />
MONITOR_FOLDERS=&#8221;/var/www&#8221;,&#8221;/etc/&#8221;<br />
#<br />
# frequenza del controllo in secondi.<br />
MONITOR_FREQUENCY=60<br />
#<br />
# esclusione dal controllo per certe directories o files, ad esempio: /etc/passwd,/etc/hosts.allow<br />
EXCLUDE=<br />
#<br />
# determina se attivare l&#8217;attività di HONEYPOT<br />
HONEYPOT=YES<br />
#<br />
# ban automatico HONEYPOT<br />
HONEYPOT_BAN=YES<br />
#<br />
# WHITELIST di indirizzi IP non vincolati dalle regole di controllo<br />
WHITELIST_IP=127.0.0.1,localhost<br />
#<br />
# PORTS su cui attivare il monitoring<br />
PORTS=&#8221;135,445,22,1433,3389,8080,21,5900,25,53,110,1723,1337,10000,5800,44443&#8243;<br />
#<br />
# determina se attivare l&#8217;alerting via email<br />
EMAIL_ALERTS=OFF<br />
#<br />
# username SMTP<br />
USERNAME=&#8221;thisisjustatest@gmail.com&#8221;<br />
#<br />
# password SMTP<br />
PASSWORD=&#8221;pass&#8221;<br />
#<br />
# destinatario<br />
SMTP_TO=&#8221;testing@test.com&#8221;<br />
#<br />
# server per l&#8217;invio, per default gmail<br />
SMTP_ADDRESS=&#8221;smtp.gmail.com&#8221;<br />
#<br />
# Porta SMTP per l&#8217;invio. Di default è quella gmail con TTLS<br />
SMTP_PORT=&#8221;587&#8243;<br />
#<br />
# Indirizzo EMAIL su cui ricevere gli ALERTS<br />
ALERT_USER_EMAIL=&#8221;user@whatever.com&#8221;<br />
#<br />
# determina se l&#8217;invio delle email di alerting debba avvenire seguendo una certa frequenza. Se impostato a off, gli alerts<br />
# verranno inviati automaticamente in tempo reale (può significare un mucchio di spam)<br />
EMAIL_TIMER=ON<br />
#<br />
# la frequenza con la quale saranno inviati gli ALERTS per email (per default ogni 10 minuti)<br />
EMAIL_FREQUENCY=600<br />
#<br />
# Attivazione del monitoraggio dei tentativi BRUTE FORCE contro SSH<br />
SSH_BRUTE_MONITOR=ON<br />
#<br />
# Quanti tentativi prima del BAN<br />
SSH_BRUTE_ATTEMPTS=4<br />
#<br />
# Per effettuare degli aggiornamenti automatici<br />
AUTO_UPDATE=OFF<br />
#<br />
# ANTI DOS imposta la macchina a limitare le connessioni, e va impostato ad OFF nel caso non lo si intenda utilizzare<br />
ANTI_DOS=ON<br />
#<br />
# Le porte dotate di protezione ANTI-DOS<br />
ANTI_DOS_PORTS=80,443<br />
#<br />
# I parametri che limitano le connessioni come misura anti DOS<br />
ANTI_DOS_THROTTLE_CONNECTIONS=50<br />
ANTI_DOS_LIMIT_BURST=200<br />
#</p>
<p>Artillery ha un set di porte (comuni o comunemente attaccate) preimpostato sulle quali si pone in ascolto.<br />
A rivelarle basta un semplice:</p>
<p># netstat -antp |grep LISTEN<br />
tcp 0 0 0.0.0.0:21 0.0.0.0:* LISTEN 2428/python<br />
tcp 0 0 0.0.0.0:53 0.0.0.0:* LISTEN 827/dnsmasq<br />
tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN 637/sshd<br />
tcp 0 0 127.0.0.1:631 0.0.0.0:* LISTEN 706/cupsd<br />
tcp 0 0 0.0.0.0:1433 0.0.0.0:* LISTEN 2428/python<br />
tcp 0 0 0.0.0.0:1337 0.0.0.0:* LISTEN 2428/python<br />
tcp 0 0 0.0.0.0:25 0.0.0.0:* LISTEN 2428/python<br />
tcp 0 0 0.0.0.0:90 0.0.0.0:* LISTEN 734/nginx -g daemon<br />
tcp 0 0 0.0.0.0:44443 0.0.0.0:* LISTEN 2428/python<br />
tcp 0 0 0.0.0.0:1723 0.0.0.0:* LISTEN 2428/python<br />
tcp 0 0 0.0.0.0:47323 0.0.0.0:* LISTEN 616/rpc.statd<br />
tcp 0 0 0.0.0.0:445 0.0.0.0:* LISTEN 2428/python<br />
tcp 0 0 0.0.0.0:3389 0.0.0.0:* LISTEN 2428/python<br />
tcp 0 0 0.0.0.0:135 0.0.0.0:* LISTEN 2428/python<br />
tcp 0 0 0.0.0.0:5800 0.0.0.0:* LISTEN 2428/python<br />
tcp 0 0 127.0.0.1:3306 0.0.0.0:* LISTEN 1089/mysqld<br />
tcp 0 0 0.0.0.0:5900 0.0.0.0:* LISTEN 2428/python<br />
tcp 0 0 0.0.0.0:110 0.0.0.0:* LISTEN 2428/python<br />
tcp 0 0 0.0.0.0:111 0.0.0.0:* LISTEN 606/rpcbind<br />
tcp 0 0 0.0.0.0:10000 0.0.0.0:* LISTEN 2428/python<br />
tcp 0 0 0.0.0.0:8080 0.0.0.0:* LISTEN 2428/python<br />
tcp6 0 0 :::53 :::* LISTEN 827/dnsmasq<br />
tcp6 0 0 :::22 :::* LISTEN 637/sshd<br />
tcp6 0 0 ::1:631 :::* LISTEN 706/cupsd<br />
tcp6 0 0 :::46327 :::* LISTEN 616/rpc.statd<br />
tcp6 0 0 :::90 :::* LISTEN 734/nginx -g daemon<br />
tcp6 0 0 :::111 :::* LISTEN 606/rpcbind<br />
tcp6 0 0 :::80 :::* LISTEN 1153/apache2<br />
&#8230;</p>
<p><strong>P.S.</strong>: L’esclusione dell’indirizzo IP che non riesca ad autenticarsi validamente viene effettuata attraverso il controllo del file /var/log/auth.log (per le distribuzioni basate su Debian).</p>
<p>Il tool e&#8217; potente ed altamente configurabile; non rimane che dare un&#8217;occhiata alla configurazione e fare qualche prova, magari all&#8217;inizio giocando con qualche servizio aperto su di una VM.</p>
<p>&nbsp;</p>
]]></content:encoded>
					
					<wfw:commentRss>https://tuttiperlinux.blog/2017/01/30/1296/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
		
		<media:content url="https://2.gravatar.com/avatar/855ab7cb725a5b56c356471b79d1cef6?s=96&#38;d=&#38;r=G" medium="image">
			<media:title type="html">lordisil72lordisil72</media:title>
		</media:content>

		<media:content url="https://tuttiperlinux.files.wordpress.com/2017/01/project-artillery.png?w=247" medium="image">
			<media:title type="html">Artillery Honeypot All-in-one</media:title>
		</media:content>
	</item>
		<item>
		<title>Proteggiti da attacchi DoS e DDoS</title>
		<link>https://tuttiperlinux.blog/2015/02/28/proteggiti-da-attacchi-dos-e-ddos/</link>
					<comments>https://tuttiperlinux.blog/2015/02/28/proteggiti-da-attacchi-dos-e-ddos/#respond</comments>
		
		<dc:creator><![CDATA[Tutti per Linux]]></dc:creator>
		<pubDate>Sat, 28 Feb 2015 21:04:18 +0000</pubDate>
				<category><![CDATA[Sicurezza]]></category>
		<category><![CDATA[SysAdmin]]></category>
		<category><![CDATA[apf firewall]]></category>
		<category><![CDATA[attacchi DDoS]]></category>
		<category><![CDATA[attacchi DoS]]></category>
		<category><![CDATA[banda utilizzata]]></category>
		<category><![CDATA[iptables]]></category>
		<category><![CDATA[monitoring]]></category>
		<category><![CDATA[munin]]></category>
		<category><![CDATA[netstat]]></category>
		<category><![CDATA[nullroute]]></category>
		<category><![CDATA[syn_flood]]></category>
		<category><![CDATA[sysctl_syncookies]]></category>
		<category><![CDATA[tcptrack]]></category>
		<category><![CDATA[tcp_ports]]></category>
		<category><![CDATA[vnstat]]></category>
		<guid isPermaLink="false">http://tuttiperlinux.com/?p=1037</guid>

					<description><![CDATA[Proteggere il server dagli attacchi DoS e DDoS  Un attacco DoS (Denial of Service), ha come scopo il rendere inutilizzabile un determinato servizio sul web, inondandolo di richieste fittizie, quindi qualsiasi servizio esposto su internet che fornisce servizi di rete basati sul protocollo TCP/IP e soggetto al potenziale rischio di attacchi DoS. La differenza tra &#8230; <a href="https://tuttiperlinux.blog/2015/02/28/proteggiti-da-attacchi-dos-e-ddos/">Continua a leggere <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<div data-shortcode="caption" id="attachment_1038" style="width: 302px" class="wp-caption alignleft"><img loading="lazy" aria-describedby="caption-attachment-1038" data-attachment-id="1038" data-permalink="https://tuttiperlinux.blog/2015/02/28/proteggiti-da-attacchi-dos-e-ddos/server-protection/#main" data-orig-file="https://tuttiperlinux.files.wordpress.com/2015/02/server-protection.jpg" data-orig-size="316,325" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Server-protection" data-image-description="&lt;p&gt;APF-Firewall Server Protection&lt;/p&gt;
" data-image-caption="&lt;p&gt;APF-Firewall Server Protection&lt;/p&gt;
" data-medium-file="https://tuttiperlinux.files.wordpress.com/2015/02/server-protection.jpg?w=292" data-large-file="https://tuttiperlinux.files.wordpress.com/2015/02/server-protection.jpg?w=316" class="size-medium wp-image-1038" src="https://tuttiperlinux.files.wordpress.com/2015/02/server-protection.jpg?w=292&#038;h=300" alt="APF-Firewall Server Protection" width="292" height="300" srcset="https://tuttiperlinux.files.wordpress.com/2015/02/server-protection.jpg?w=292&amp;h=300 292w, https://tuttiperlinux.files.wordpress.com/2015/02/server-protection.jpg?w=146&amp;h=150 146w, https://tuttiperlinux.files.wordpress.com/2015/02/server-protection.jpg 316w" sizes="(max-width: 292px) 100vw, 292px" /><p id="caption-attachment-1038" class="wp-caption-text">APF-Firewall Server Protection</p></div>
<p><strong>Proteggere il server dagli attacchi DoS e DDoS </strong></p>
<p>Un attacco DoS (Denial of Service), ha come scopo il rendere inutilizzabile un determinato servizio sul web, inondandolo di richieste fittizie, quindi qualsiasi servizio esposto su internet che fornisce servizi di rete basati sul protocollo TCP/IP e soggetto al potenziale rischio di attacchi DoS. La differenza tra DoS e DDoS (Distributed Denial of Service) sta nel numero di macchine (PC, server, cellulari, in generale, qualsiasi dispositivo connesso ad internet che sia stato compromesso) utilizzate per lanciare l&#8217;attacco. Nel caso di un DoS l&#8217;attacco avviene da una sola macchina, mentre (nel ben piu difficile caso da bloccare) nel DDoS l&#8217;attacco puo avvenire contemporaneamente da centinaia di macchine diverse.</p>
<p>Come potrete quindi immaginare tutti i consigli contenuti in questo articolo non vi assicureranno una protezione totale contro i DDoS, perché quando sono ben organizzati e l’attacco arriva da un grande numero di macchine diverse, l’unico modo per cercare di bloccarlo o più realisticamente, mitigarlo, è agire a monte, direttamente sull’infrastruttura del vostro provider (che quindi dovrete contattare), a meno che non abbiate una vostra infrastruttura di rete.</p>
<p><strong>Come riconoscere un attacco </strong>?</p>
<p>Questa è sicuramente la prima cosa da imparare, ossia imparare a riconoscere un attacco DoS, perche&#8217; tante volte si corre il rischio di pensare ad un attacco di questo tipo appena i servizi ospitati sul server risultano irraggiungibili, quando invece le cose più probabili sono ben altre.<br />
Innanzitutto se siete sotto attacco vedrete sicuramente un picco (che può variare da pochi a diversi mbit/s) nei vostri grafici della banda utilizzata, ed un picco nelle connessioni netstat, anche per questo sarebbe bene generare dei grafici di tutto rispetto magari tramite Munin (di cui parleremo nel prossimo articolo) o con <a title="Grafici di rete con Vnstat" href="http://tuttiperlinux.com/2014/08/01/238/">Vnstat</a>, i servizi più importanti sul vostro server.</p>
<p>Una volta accertato che ci sono effettivamente picchi anomali nell’utilizzo della banda, usate questo comando per visualizzare lo stato di tutte le connessioni attive sul vostro server:</p>
<pre>netstat -nat | awk ‘{print $6}’ | sort | uniq -c | sort –n</pre>
<p>L’output sarà qualcosa del genere:</p>
<pre>1 CLOSING

1 established

1 Foreign

7 LAST_ACK

25 FIN_WAIT1

26 LISTEN

69 FIN_WAIT2

484 TIME_WAIT

542 ESTABLISHED</pre>
<p>Se notate che ci sono diverse connessioni in stato <strong>SYS_SENT</strong> siete sicuramente sotto attacco, a questo punto non resta altro da fare che individuare l’IP o gli IP dai quali arrivano più connessioni, potete farlo con questo comando:</p>
<pre>netstat -atun | awk ‘{print $5}’ | cut -d: -f1 | sed -e ‘/^$/d’ |sort | uniq -c | sort –n</pre>
<p>A questo punto avrete una lista ordinata per numero di connessioni aperte da ogni IP, ed alla fine, molto probabilmente, avrete gli IP delle macchine dalle quali vi stanno attaccando, ora non resta che bloccare questi IP.<br />
Una utility molto utile per analizzare il traffico di rete e vederlo in tempo reale è <strong>tcptrack</strong>, una volta installata usate i seguenti comandi per avviare il monitoring:</p>
<p><strong>tcptrack -i eth0</strong> vi mostrerà tutto il traffico attivo sulla scheda di rete</p>
<p><strong>tcptrack -i eth0</strong> <strong>port 80</strong> vi mostrerà tutto il traffico sulla porta 80</p>
<p>Es:</p>
<pre>tcptrack -i eth0 src or dst 192.168.2.138</pre>
<p>vi mostrerà tutto il traffico generato dall’ip specificato. In più tcptrack vi mosterà in tempo reale l’utilizzo della banda.</p>
<p><strong>Bloccare un attacco</strong></p>
<p>Ora che sappiamo individuare un attacco e capire da quali IP sta arrivando possiamo cercare di bloccarlo, vediamo come.<br />
Premesso che la cosa migliore sarebbe comunicare gli IP degli attaccanti al vostro provider così che possano essere bloccati a monte e che non possano quindi influire neanche minimamente sulla vostra banda disponibile, esistono principalmente due metodi per bloccare questi IP sul vostro server: bloccarli con<strong> iptables</strong>, oppure metterli in <strong>nullroute</strong> (che è, secondo me, preferibile).</p>
<p>Per bloccare questi IP da itptables potete usare questo semplice comando:</p>
<p><strong>iptables -A INPUT -s IP-ATTACCANTE -j DROP</strong></p>
<p>Invece, per mettere un IP in nullroute, dobbiamo lanciare questo comando:</p>
<p><strong>route add IP-ATTACANTE gw 127.0.0.1 lo</strong></p>
<p>Possiamo anche mettere in nullroute un&#8217; intera subnet ad esempio così:</p>
<p><strong>route add -net 192.168.2.0/24 gw 127.0.0.1 lo</strong></p>
<p>Verifichiamo quindi che i settaggi siano stati effettivamente applicati con</p>
<p><strong>netstat -nr<br />
</strong></p>
<p>Per rimuovere il nullroute possiamo utilizzare il comando <strong>route delete IP</strong></p>
<p>Per far sì che i nullroute impostati vengano mantenuti al reboot dovrete scrivere gli stessi comandi di prima nel file /etc/rc.local</p>
<p><strong><br />
Come prevenire gli attacchi</strong></p>
<p>Fin’ora abbiamo visto come comportarci una volta sotto attacco, ora vediamo cosa possiamo fare per evitare di trovarci coi servizi down e doverli ripristinare.<br />
Per prima cosa consiglio di installare <strong>APF</strong> (Advanced Policy Firewall), un firewall basato su iptables che bloccherà autonomamente molti degli attacchi conosciuti, confrontandone i pattern, in più, grazie alla sua semplice e versatile configurazione diventa un&#8217;ottimo sostituto di iptables che spesso risulta abbastanza macchinoso da mantenere.</p>
<p>Potete installare APF usando un packet manager tipo apt o yum, oppure compilando l’ultima versione :</p>
<p>Scaricate l’ultima versione stabile:</p>
<p><strong>wget <a href="http://www.rfxnetworks.com/downloads/apf-current.tar.gz" rel="nofollow">http://www.rfxnetworks.com/downloads/apf-current.tar.gz</a></strong></p>
<p>Scompattate il file appena scaricato: <strong>tar -xvzf apf-current.tar.gz</strong></p>
<p>Entrate nella directory creata ed eseguite <strong>./install.sh</strong></p>
<p>A questo punto APF va configurato a dovere e, per farlo, bastera&#8217; editare il file <strong>/etc/apf/conf.apf</strong> .</p>
<p>Per prima cosa bisognera&#8217; settare il parametro <strong>DEVEL_MODE</strong> a 1, così se sbagliate qualche settaggio e vi chiudete fuori dal server, dopo 5 minuti il firewall verrà automaticamente stoppato.</p>
<p>Questo parametro indica se apf è in modalità sviluppo (e quindi non applica le regole) o in modalità produzione e quindi rende effettive le regole del firewall, prima di impostarlo a 0 per renderlo attivo modifichiamo il resto delle regole altrimenti rischiamo di chiuderci fuori dal server</p>
<p>Impostiamo le porte in ascolto modificando il paramentro IG_TCP_CPORTS</p>
<pre># Common inbound (ingress) TCP ports
IG_TCP_CPORTS="22,21,20,80,25,53,110,143,443,2222,587,953,993,995,4949"</pre>
<p>io utilizzo queste impostazioni che sono per i servizi ssh,ftp,web,mail (pop/imap/smtp), directadmin e munin</p>
<div>e queste sono le impostazioni per le porte in uscita</div>
<pre># Common outbound (egress) TCP ports
EG_TCP_CPORTS="21,25,80,443,43"</pre>
<p>e poi più sotto impostiamo a “1″ le seguenti variabili che ci permettono di scaricare delle liste di ip conosciuti come malevoli in modo da filtrare a priori il loro traffico</p>
<pre>DLIST_PHP="1"
DLIST_SPAMHAUS="1"
DLIST_DSHIELD="1"
DLIST_RESERVED="1"</pre>
<p><strong>Ricordatevi</strong> di rimettere su <strong>0</strong> questo parametro una volta terminata la configurazione, altrimenti il firewall funzionerà solo per 5 minuti ad ogni riavvio.</p>
<p>Settate su <strong>1</strong> tutti i parametri che abilitano le liste di network malefici dai quali le connessioni saranno rifiutate (DLIST_*).</p>
<p>Settate manualmente le porte TCP che devono rimanere aperte nella variabile IG_TCP_CPORTS (ad esempio la 80 per il traffico web, se avete modificato la porta di ssh come avreste dovuto fare ricordatevi di settarla qua, altrimenti vi chiuderete fuori dal server), tutte le altre risulteranno chiuse.</p>
<p>Stessa cosa per le porte UDP subito sotto, se ne fate uso.</p>
<p>Impostando il parametro <strong>SYSCTL_SYNCOOKIES</strong> su 1, vi proteggerà dagli attacchi di tipo <strong>syn flood</strong>.</p>
<p>salviamo ed avviamo apf con</p>
<pre>apf -s</pre>
<p>#Proteggiti#AttacchiDoSeDDoS</p>
]]></content:encoded>
					
					<wfw:commentRss>https://tuttiperlinux.blog/2015/02/28/proteggiti-da-attacchi-dos-e-ddos/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
		
		<media:content url="https://2.gravatar.com/avatar/855ab7cb725a5b56c356471b79d1cef6?s=96&#38;d=&#38;r=G" medium="image">
			<media:title type="html">lordisil72lordisil72</media:title>
		</media:content>

		<media:content url="https://tuttiperlinux.files.wordpress.com/2015/02/server-protection.jpg?w=292" medium="image">
			<media:title type="html">APF-Firewall Server Protection</media:title>
		</media:content>
	</item>
		<item>
		<title>Grafici di rete con Vnstat</title>
		<link>https://tuttiperlinux.blog/2014/08/01/238/</link>
					<comments>https://tuttiperlinux.blog/2014/08/01/238/#comments</comments>
		
		<dc:creator><![CDATA[Tutti per Linux]]></dc:creator>
		<pubDate>Fri, 01 Aug 2014 17:59:15 +0000</pubDate>
				<category><![CDATA[Networking]]></category>
		<category><![CDATA[apache]]></category>
		<category><![CDATA[banda]]></category>
		<category><![CDATA[ip link]]></category>
		<category><![CDATA[linux]]></category>
		<category><![CDATA[localhost]]></category>
		<category><![CDATA[monitoring]]></category>
		<category><![CDATA[php frontend]]></category>
		<category><![CDATA[rete]]></category>
		<category><![CDATA[vnstat]]></category>
		<guid isPermaLink="false">http://tuttiperlinux.wordpress.com/?p=238</guid>

					<description><![CDATA[Controllare la banda Sui server, come sui PC, è utile monitorare e raccogliere dati circa l’utilizzo della banda di rete. E&#8217; possibile utilizzare vnstat per avere un monitoraggio in tempo reale della banda; questo piccolo programma ha qualcosa in più degli altri, oltre a mostrare statistiche in tempo reale, la caratteristica in cui brilla questo piccolo programma &#8230; <a href="https://tuttiperlinux.blog/2014/08/01/238/">Continua a leggere <span class="meta-nav">&#8594;</span></a>]]></description>
										<content:encoded><![CDATA[<h3><strong><a href="https://tuttiperlinux.files.wordpress.com/2014/08/vnstat-php-frontend-screenshots.png"><img loading="lazy" data-attachment-id="242" data-permalink="https://tuttiperlinux.blog/2014/08/01/238/vnstat-php-frontend-screenshots/#main" data-orig-file="https://tuttiperlinux.files.wordpress.com/2014/08/vnstat-php-frontend-screenshots.png" data-orig-size="593,424" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="vnstat-php-frontend-screenshots" data-image-description="" data-image-caption="" data-medium-file="https://tuttiperlinux.files.wordpress.com/2014/08/vnstat-php-frontend-screenshots.png?w=300" data-large-file="https://tuttiperlinux.files.wordpress.com/2014/08/vnstat-php-frontend-screenshots.png?w=593" class="alignleft size-medium wp-image-242" src="https://tuttiperlinux.files.wordpress.com/2014/08/vnstat-php-frontend-screenshots.png?w=300&#038;h=214" alt="vnstat-php-frontend-screenshots" width="300" height="214" srcset="https://tuttiperlinux.files.wordpress.com/2014/08/vnstat-php-frontend-screenshots.png?w=300&amp;h=214 300w, https://tuttiperlinux.files.wordpress.com/2014/08/vnstat-php-frontend-screenshots.png?w=150&amp;h=107 150w, https://tuttiperlinux.files.wordpress.com/2014/08/vnstat-php-frontend-screenshots.png 593w" sizes="(max-width: 300px) 100vw, 300px" /></a></strong></h3>
<h3><strong>Controllare la banda</strong></h3>
<p>Sui server, come sui PC, è utile monitorare e raccogliere dati circa l’utilizzo della banda di rete. E&#8217; possibile utilizzare <strong>vnstat</strong> per avere un monitoraggio in tempo reale della banda; questo piccolo programma ha qualcosa in più degli altri, oltre a mostrare statistiche in tempo reale, la caratteristica in cui brilla questo piccolo programma è la sua capacità di raccogliere dati su un lungo periodo di tempo. <code>vnstat </code>è un monitor di traffico di rete basata su console per Linux e BSD che mantiene un log del traffico di rete per l’interfaccia/e che gli indicherete nel file di conf. Utilizza le statistiche dell’interfaccia di rete fornite dal kernel come fonte di informazioni, ciò significa che vnstat non sta effettivamente sniffando il traffico, inoltre assicura anche un basso impatto sull’uso delle risorse di sistema.</p>
<p>In Linux, è richiesto almeno un kernel della serie 2.2, che vuol dire che tutti oggigiorno sono in grado di utilizzare questo piccolo programma.</p>
<p>Il programma è open source/GPL e può essere utilizzato sia come root che come utente non privilegiato.</p>
<p><strong>INSTALLAZIONE</strong></p>
<pre>sudo apt-get install vnstat
                     vnstati
                     apache2
                     php5
                     php5-gd
</pre>
<h3>Primo setup</h3>
<p>Durante la prima esecuzione è necessario inizializzare ogni interfaccia che desiderate registrare su vnstat. Ad esempio per una interfaccia cablata con cavo di rete è necessario utilizzare il comando:</p>
<div class="wp_syntax">
<table>
<tbody>
<tr>
<td class="code">
<pre># vnstat -u -i eth0</pre>
</td>
</tr>
</tbody>
</table>
</div>
<p>o per una interfaccia wireless:</p>
<div class="wp_syntax">
<table>
<tbody>
<tr>
<td class="code">
<pre># vnstat -u -i wlan0</pre>
</td>
</tr>
</tbody>
</table>
</div>
<p>Quando si inizializza una interfaccia per la prima volta ci potrà essere un messaggio di errore che stamperà ‘unable to read database’. Se questo messaggio è seguito da un messaggio di informazioni che dice ‘a new database has been created’ l’interfaccia è stata aggiunta con successo.<br />
Se questo non accade verificare che l’interfaccia specificata sia valida.</p>
<p>Per vedere tutte le interfacce del vostro sistema Linux, è possibile utilizzare il comando</p>
<div class="wp_syntax">
<table>
<tbody>
<tr>
<td class="code">
<pre> ip link show</pre>
</td>
</tr>
</tbody>
</table>
</div>
<pre> ... ora scarichiamo il pacchetto vnstat_php_frontend nel seguente modo :</pre>
<pre># cd /tmp
# wget http://www.sqweek.com/sqweek/files/vnstat_php_frontend-1.5.1.tar.gz</pre>
<pre class="bash">scompattiamolo nel percorso dei file di Apache ( /var/www/html )</pre>
<pre># sudo tar zxvf vnstat_php_frontend-1.5.1.tar.gz -C /var/www/html/</pre>
<p>a questo punto non rimane altro che spostarci nel percorso sopra indicato in cui potremo trovare la nuova directory<br />
# cd /var/www/html<br />
** rinominiamo x maggiore comodita&#8217; da &#8220;vnstat_php_frontend-1.5.1&#8221; a semplicemente vnstat<br />
# sudo mv vnstat_php_frontend-1.5.1 vnstat</p>
<p>&#8230;. spostiamoci all&#8217;interno della Directory vnstat ed andiamo a fare alcune veloci modifiche che ci permetteranno di diventare subito operativi.</p>
<p># cd vnstat<br />
&#8230;effettuiamo come consuetudine un backup del file config.php prima di fare qualunque modifica<br />
# cp config.php config.php.bck</p>
<p>ora possiamo passare ad editare il file in questione e ad apportare le seguenti modifiche :<br />
# vim config.php</p>
<pre>*** modifichiamo nel seguente modo
$locale = 'en_US.UTF-8';
$language = '<strong>en</strong>';</pre>
<pre>$iface_list = array('<strong>eth0</strong>', '<strong>eth1</strong>'); # nel mio caso ho modificato le interfacce con la mia <strong>wlan0 

</strong></pre>
<pre>$iface_title['wlan0'] = '<strong>Internal</strong>';
// $iface_title['eth1'] = '<strong>External</strong>'; # se non avete due o piu' interfacce da monitorare potete commentarla</pre>
<p>&#8230;salvate ed uscite dal file; a questo punto bastera&#8217; puntare il browser all&#8217;URL</p>
<pre>http://localhost/vnstat/
</pre>
<p>&nbsp;</p>
<pre class="bash">da qui in avanti potrete tenere sotto controllo i consumi della/e vostra interfaccia di rete (ora,giorno,mese).</pre>
]]></content:encoded>
					
					<wfw:commentRss>https://tuttiperlinux.blog/2014/08/01/238/feed/</wfw:commentRss>
			<slash:comments>1</slash:comments>
		
		
		
		<media:content url="https://2.gravatar.com/avatar/855ab7cb725a5b56c356471b79d1cef6?s=96&#38;d=&#38;r=G" medium="image">
			<media:title type="html">lordisil72lordisil72</media:title>
		</media:content>

		<media:content url="https://tuttiperlinux.files.wordpress.com/2014/08/vnstat-php-frontend-screenshots.png?w=300" medium="image">
			<media:title type="html">vnstat-php-frontend-screenshots</media:title>
		</media:content>
	</item>
	</channel>
</rss>
